<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE mapper
  PUBLIC '-//mybatis.org//DTD Mapper 3.0//EN'
  'http://mybatis.org/dtd/mybatis-3-mapper.dtd'>


<mapper namespace='io.rezoome.manager.database.dao.xml.agency.Dao'>
	<resultMap id="OpicResultEntity" type="opic_result">
		<result property="name" column="ENAME" />
		<result property="testId" column="TESTID" />
		<result property="testDay" column="ISSUDATE" />
		<result property="rating" column="RATING" />
	</resultMap>

	<select id="getRecordByCi" parameterType="db_entity" resultMap="OpicResultEntity">
		select
		CNAME, TESTID, CNATION, CLEVEL
		from TBL_EXAM
		where
		ci = #{ci}
		limit 1
	</select>

	<select id="getRecordsByName" parameterType="db_entity"
		resultMap="OpicResultEntity">
		select
		CNAME, TESTID, CNATION, CLEVEL
		from TBL_EXAM
		where
		CNAME = #{username} AND
		BIRTH = #{birth} AND
		gender = #{gender}
	</select>

	<select id="getRecordsByPhone" parameterType="db_entity"
		resultMap="OpicResultEntity">
		select
		CNAME, TESTID, CNATION, CLEVEL
		from TBL_EXAM
		where
		phone = #{phone} AND
		email = #{email}
	</select>
	
	<select id="getUserCountByCI" parameterType="db_entity" resultMap="Integer">
		 SELECT COUNT(*) FROM OPIC_CERT WHERE ENAME = #{username}
	</select>

	<select id="getCertRecords" parameterType="db_entity" resultMap="OpicResultEntity">
		 SELECT ENAME, TESTID, ISSUDATE, RATING, PHONE FROM OPIC_CERT WHERE ENAME = #{username}
	</select>
</mapper>